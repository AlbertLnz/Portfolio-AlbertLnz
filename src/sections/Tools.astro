---
import { tools } from "@/data/tools"
const MAX_TOOLS_ITEMS = 99
---

<section id="tools" class="relative">
  <ul class="flex flex-wrap w-full h-full">
    {
      tools.slice(0, MAX_TOOLS_ITEMS).map((tool) => {
        return (
          <li>
            <button id={tool.name} transition:name={tool.name} class="flex items-center justify-center hover:scale-110 p-1 transition-all duration-300 opacity-70 hover:opacity-100">
              {<tool.component class="size-5" />}
            </button>
            <div id={`info-container-${tool.name}`} transition:name={tool.name} class="hidden relative h-full items-center justify-center gap-x-2">
              {<tool.component class="size-14 h-auto"/>}
              <p class="text-[11px] text-[#A3A3A3]">{tool.description}</p>
            </div>
          </li>
        )
      })
    }
  </ul>
  <button id="back-btn" class="hidden absolute top-0 left-0 p-4 text-xs text-[#737373] hover:text-white">Back</button>
  <p class="absolute text-xs text-[#737373] bottom-0 right-0 p-2">Tools I use daily as a programmer</p>
</section>

<script>
  const $ = (el: string): HTMLElement | null => document.querySelector(el)
  const $$ = (els: string): NodeListOf<Element> => document.querySelectorAll(els)

  const $$buttons: NodeListOf<HTMLButtonElement> = $$('button') as NodeListOf<HTMLButtonElement>
  const $backBtn: HTMLElement | null = $(`#back-btn`)
  const $$infoContainers = $$('[id^="info-container-"]');
  
    $$buttons.forEach((button: HTMLButtonElement) => {
      button.addEventListener('click', () => {
        const $infoContainer: HTMLElement | null = $(`#info-container-${button.id}`)
        
          $$buttons.forEach((btn) => {
            btn.classList.add('hidden')
          })

          $infoContainer?.classList.remove('hidden')
          $infoContainer?.classList.add('flex')
          $backBtn?.classList.remove('hidden')
    })

    $backBtn?.addEventListener('click', () => {
      const toggleVisibility = (element: Element, show: boolean) => {
        element.classList.toggle('hidden', !show)
        element.classList.toggle('flex', show)
      }

      $$buttons.forEach((btn) => toggleVisibility(btn, true)) // Mostrar botones
      $$infoContainers.forEach((infoContainer) => toggleVisibility(infoContainer, false)) // Ocultar contenedores
      toggleVisibility($backBtn, false)
    })

  })
</script>
